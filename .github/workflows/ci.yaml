name: Integration Test

# on:
#   push:
#     branches:
#       - master
#   pull_request:

on: push

jobs:
  build:
    name: Integration Test
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
        with:
          fetch-depth: 1
          path: /home/runner/go/src/github.com/muxinc/mux-go
      - name: Install Go
        uses: actions/setup-go@v1
      - name: Make gobin dir
        run: mkdir -p /home/runner/go/bin
      - name: Install Dep
        run: curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
        env: 
          GOPATH: /home/runner/go
      - name: Debug
        run: |
          pwd
          echo ${HOME}
          echo ${GITHUB_WORKSPACE}
          echo ${GOPATH}
          echo ${GOROOT}
        env: 
          GOPATH: /home/runner/go
      - name: Dep Ensure
        run: |
          cd /home/runner/go/src/github.com/muxinc/mux-go
          export PATH=$PATH:$(go env GOPATH)/bin
          dep ensure
        env: 
          GOPATH: /home/runner/go
      # - name: Run Integration Tests
      #   env:
      #     MUX_TOKEN_ID: ${{ secrets.MUX_TOKEN_ID }}
      #     MUX_TOKEN_SECRET: ${{ secrets.MUX_TOKEN_SECRET }}
      #   run: bash test.sh
